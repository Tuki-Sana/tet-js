<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <title>テトリス</title>
  <link rel="stylesheet" href="css/style.css">
</head>
<body>
  <!-- スタート画面（1ページ目：ルール説明） -->
  <div id="start-screen" class="screen active">
    <div class="start-container">
      <div class="title-section">
        <h1>🎮 テトリス 🎮</h1>
        <p class="subtitle">落ちてくるテトラミノを操作してラインを消去しよう！</p>
      </div>

      <div class="rules-grid">
        <!-- 操作方法 -->
        <div class="rule-card">
          <h3>操作方法</h3>
          <div class="controls-compact">
            <div class="control-item">
              <span class="control-desc">移動</span>
              <span class="control-keys">
                <span class="key">A</span><span class="key">D</span> / タップ
              </span>
            </div>
            <div class="control-item">
              <span class="control-desc">回転</span>
              <span class="control-keys">
                <span class="key">W</span> / 上部タップ
              </span>
            </div>
            <div class="control-item">
              <span class="control-desc">高速落下</span>
              <span class="control-keys">
                <span class="key">S</span> / 下部長押し
              </span>
            </div>
            <div class="control-item">
              <span class="control-desc">一時停止</span>
              <span class="control-keys">
                <span class="key">ESC</span>
              </span>
            </div>
          </div>
        </div>

        <!-- スコア -->
        <div class="rule-card">
          <h3>スコア</h3>
          <div class="score-list">
            <div class="score-item">1行消去<span>100×レベル</span></div>
            <div class="score-item">2行消去<span>300×レベル</span></div>
            <div class="score-item">3行消去<span>500×レベル</span></div>
            <div class="score-item">4行消去<span>800×レベル</span></div>
          </div>
        </div>

        <!-- スマホ専用説明 -->
        <div class="rule-card mobile-only">
          <h3>タップ操作</h3>
          <div class="mobile-controls-guide">
            <div class="tap-area-demo">
              <div class="demo-area demo-rotate">回転</div>
              <div class="demo-area demo-left">左</div>
              <div class="demo-area demo-right">右</div>
              <div class="demo-area demo-down">高速落下</div>
            </div>
          </div>
        </div>
      </div>

      <button class="start-btn" onclick="startGame()">ゲーム開始</button>
    </div>
  </div>

  <!-- ゲーム画面（2ページ目：プレイ専用） -->
  <div id="game-screen" class="screen">
    <!-- PC版レイアウト -->
    <div class="game-layout-pc">
      <!-- 左パネル -->
      <div class="left-panel">
        <div class="score-panel">
          <div class="score-item">
            <span class="score-label">スコア</span>
            <span class="score-value" id="score">0</span>
          </div>
          <div class="score-item">
            <span class="score-label">レベル</span>
            <span class="score-value" id="level">1</span>
          </div>
          <div class="score-item">
            <span class="score-label">最高</span>
            <span class="score-value" id="high-score">0</span>
          </div>
        </div>
      </div>

      <!-- 中央ゲームエリア -->
      <div class="center-game">
        <div class="game-area">
          <!-- タップゾーン（スマホのみ） -->
          <div id="tap-zones" class="tap-zones">
            <div class="tap-zone tap-rotate" data-action="rotate"></div>
            <div class="tap-zone tap-left" data-action="left"></div>
            <div class="tap-zone tap-right" data-action="right"></div>
            <div class="tap-zone tap-down" data-action="down"></div>
          </div>
          <canvas id="game" width="300" height="600"></canvas>
        </div>
      </div>

      <!-- 右パネル -->
      <div class="right-panel">
        <div class="next-panel">
          <h4>NEXT</h4>
          <div class="next-list">
            <canvas id="next-piece-1" width="60" height="60"></canvas>
            <canvas id="next-piece-2" width="50" height="50"></canvas>
            <canvas id="next-piece-3" width="50" height="50"></canvas>
          </div>
        </div>
      </div>
    </div>

    <!-- スマホ版レイアウト -->
    <div class="game-layout-mobile">
      <!-- 上部情報 -->
      <div class="mobile-header">
        <div class="mobile-score">
          <span id="mobile-score">0</span>
          <small>スコア</small>
        </div>
        <div class="mobile-level">
          <span id="mobile-level">1</span>
          <small>レベル</small>
        </div>
        <div class="mobile-next">
          <canvas id="mobile-next" width="40" height="40"></canvas>
          <small>NEXT</small>
        </div>
      </div>

      <!-- ゲームエリア -->
      <div class="mobile-game-area">
        <div class="game-area">
          <div id="mobile-tap-zones" class="tap-zones">
            <div class="tap-zone tap-rotate" data-action="rotate"></div>
            <div class="tap-zone tap-left" data-action="left"></div>
            <div class="tap-zone tap-right" data-action="right"></div>
            <div class="tap-zone tap-down" data-action="down"></div>
          </div>
          <canvas id="mobile-game" width="280" height="560"></canvas>
        </div>
      </div>
    </div>
  </div>

  <!-- ESC メニュー -->
  <div id="pause-menu" class="modal">
    <div class="modal-content">
      <h2>⏸️ 一時停止</h2>
      <div class="menu-buttons">
        <button onclick="resumeGame()" class="resume-btn">▶️ ゲーム再開</button>
        <button onclick="restartGame()" class="restart-btn">🔄 やり直し</button>
        <button onclick="backToMenu()" class="menu-btn">メニューに戻る</button>
      </div>
      <p class="menu-hint">ESCキーで再開できます</p>
    </div>
  </div>

  <!-- ゲームオーバー -->
  <div id="game-over" class="modal">
    <div class="modal-content">
      <h2>ゲームオーバー</h2>
      <div class="result-stats">
        <div class="stat">
          <span class="stat-label">最終スコア</span>
          <span class="stat-value" id="final-score">0</span>
        </div>
        <div class="stat">
          <span class="stat-label">到達レベル</span>
          <span class="stat-value" id="final-level">1</span>
        </div>
      </div>
      <div class="menu-buttons">
        <button onclick="restartGame()" class="restart-btn">🔄 再挑戦</button>
        <button onclick="backToMenu()" class="menu-btn">メニューに戻る</button>
      </div>
    </div>
  </div>

  <script src="js/tetris.js"></script>
</body>
</html>
